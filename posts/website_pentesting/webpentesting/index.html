

<!DOCTYPE html>
<html lang="en" data-mode="dark">
  <head prefix="og: http://ogp.me/ns#">
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="Hugo 0.89.4 -- gohugo.io / Color Your World -- gitlab.com/rmaguiar/hugo-theme-color-your-world">
























<title>Website Penetration Testing | Somerset&#39;s Blog</title>


<meta name="author" content="Somerset">



<meta name="robots" content="index follow">
<meta name="referrer" content="no-referrer-when-downgrade">




  
    <link rel="canonical" href="https://s0merset7.github.io/posts/website_pentesting/webpentesting/">
  





  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">





<meta property="og:site_name" content="Somerset&#39;s Blog">
<meta property="og:title" content="Website Penetration Testing">

  <meta property="og:url" content="https://s0merset7.github.io/posts/website_pentesting/webpentesting/">








  <meta property="og:type" content="article">
  
  
    <meta property="article:published_time" content="2021-05-31">
    <meta property="article:modified_time" content="2021-05-31">
    <meta property="og:updated_time" content="2021-05-31">
  

  
  
  
    <meta name="twitter:creator" content="@s0merset7">
  
  

  <meta name="twitter:site" content="@s0merset7">







  <meta name="twitter:dnt" content="on">












<meta name="theme-color" content="#222">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">










  

    
    

    

      
      
    

  

    
    

    

      
      
    

  

    
    

    
    
      
      
    

  

    
    

    

      
        
      
      
    

  

    
    

    

      
      
    

  

    
    

    

      
      
    

  

    
    

    

      
      
    

  

    
    

    

      
        
      
      
    

  

    
    

    
    
      
      
    

  

    
    

    
    
      
      
    

  

    
    

    

      
      
    

  

    
    

    
    
      
      
    

  

    
    

    
    
      
      
    

  

    
    

    

      
      
    

  

    
    

    
    
      
      
    

  

    
    

    

      
      
    

  

    
    

    

      
      
    

  

    
    

    

      
      
    

  

    
    

    

      
      
    

  

    
    

    

      
      
    

  

    
    

    

      
      
    

  

    
    

    

      
        
      
      
    

  

    
    

    

      
      
    

  

    
    

    

      
      
    

  

    
    

    

      
      
    

  

    
    

    

      
      
    

  







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Article",
      "mainEntityOfPage": {
        "@type": "WebSite",
        "@id": "https:\/\/s0merset7.github.io\/"
      },
      "headline": "Website Penetration Testing",
      "description": "",
      
      "url": "https:\/\/s0merset7.github.io\/posts\/website_pentesting\/webpentesting\/",
      "inLanguage": "en",
      "datePublished": "2021-05-31",
      "dateModified": "2021-05-31",
      "wordCount" : "3425",
      "publisher": {
        "@type": "Person",
        "name": "Somerset"
      },
      "author": {
        "@type": "Person",
        "name": "Somerset",
        "description": "Cybersecuirty enthusiast learning what I can",
        "sameAs": ["https://github.com/s0merset7","https://www.linkedin.com/in/ryan-dinnan","https://twitter.com/s0merset7"]
      }
    }
  </script>






<link rel="stylesheet" href="/css/main.min.9ee32856170fec5024ff3829de02718c5f0870bfc1633f7aec8c84308e36821eba2d10df209342c3c2610bf537fd3eb7a4e41ae80b62d67bcc622c7c1fd133df.css" integrity="sha512-nuMoVhcP7FAk/zgp3gJxjF8IcL/BYz967IyEMI42gh66LRDfIJNCw8JhC/U3/T63pOQa6Ati1nvMYix8H9Ez3w==">



<noscript>

  
  

  

    
      <meta name="theme-color" content="#902b37">
    

  

  <style>
  
    html {
      --accent: #902b37;
    }
  
    .req-js,
    img.lazyload {
      display: none;
    }
    
  </style>
  
</noscript>






  <link rel="preload" href="/fonts/open-sans-v17-latin-700.woff" as="font" crossorigin="anonymous">

  <link rel="preload" href="/fonts/open-sans-v17-latin-700.woff2" as="font" crossorigin="anonymous">

  <link rel="preload" href="/fonts/open-sans-v17-latin-italic.woff" as="font" crossorigin="anonymous">

  <link rel="preload" href="/fonts/open-sans-v17-latin-italic.woff2" as="font" crossorigin="anonymous">

  <link rel="preload" href="/fonts/open-sans-v17-latin-regular.woff" as="font" crossorigin="anonymous">

  <link rel="preload" href="/fonts/open-sans-v17-latin-regular.woff2" as="font" crossorigin="anonymous">

  <link rel="preload" href="/fonts/oswald-v29-latin-700.woff" as="font" crossorigin="anonymous">

  <link rel="preload" href="/fonts/oswald-v29-latin-700.woff2" as="font" crossorigin="anonymous">





<script defer src="/js/lazysizes.min.min.a119ca60ecfe388cd8593368571986e9a789685d5d68c3c37cab079ff3ddd67c14f15acf56cbd8e554f09111201f5e46a6ed24138139d0820254a1342b92507c.js" crossorigin="anonymous"></script>








  <link rel="me" href="https://github.com/s0merset7"> 

  <link rel="me" href="https://www.linkedin.com/in/ryan-dinnan"> 

  <link rel="me" href="https://twitter.com/s0merset7"> 







  <script>
    
      'use strict';const ROOT=document.documentElement,SHEET=document.documentElement.style,META_THEME_COLOR=document.querySelector('meta[name=theme-color]');function setDark(){ROOT.dataset.mode='dark'}function setLight(){ROOT.dataset.mode='light'}localStorage.getItem('isDark')=='true'?setDark():localStorage.getItem('isDark')=='false'&&setLight(),function getAccent(){var a;return ROOT.dataset.mode==='dark'?localStorage.getItem('darkAccent')===null?(SHEET.setProperty('--accent',activeAccent),META_THEME_COLOR.setAttribute('content',activeAccent);function updateAccent(){var a=getAccent();SHEET.setProperty('--accent',a),PALETTE.value=a,META_THEME_COLOR.setAttribute('content',a)}document.addEventListener('DOMContentLoaded',function(){PALETTE.value=activeAccent;function a(){document.body.style.transition=document.querySelector('header').style.transition=document.querySelector('footer').style.transition='background-color .3s ease, color .3s ease'}function b(){a(),ROOT.dataset.mode=='light'?(setDark(),localStorage.setItem('isDark','true'),console.log("Mode changed to 'dark' by the user.")):(setLight(),localStorage.setItem('isDark','false'),console.log("Mode changed to 'light' by the user.")),updateAccent()}document.querySelector('footer button').addEventListener('click',b)})
    
  </script>



  </head>

  <body>

    <header>
      

  <a href="/">Somerset&#39;s Blog</a>




  
    <nav aria-label="Main menu.">
      <ul>
        
          <li>
            <a class="btn" href="/about/">About</a>
          </li>
        
          <li>
            <a class="btn" href="/posts/">Posts</a>
          </li>
        
          <li>
            <a class="btn" href="/contact/">Contact</a>
          </li>
        
      </ul>
    </nav>
  


    </header>

    <div class="filler">
      

  <main>
    <article>
      <header>
        
        <h1>Website Penetration Testing</h1>
        
        

        
          <section class="terms">
            <ul><li><a class="btn" href="/tags/burp-suite/">Burp Suite</a></li><li><a class="btn" href="/tags/pentesting/">Pentesting</a></li></ul>
          </section>
          <p>
            
              Published on <time datetime="2021-05-31">2021-05-31</time>
            
          </p>
        
        
        
        
      </header>
    
      
      
      





















  




<style>
	main {
    margin: 90px auto;
    padding: 0 15px;
    max-width: 70%;
	}
</style>
<p><em>Note: Much of the below information is summarized from <a href="https://ethicalhackingblog.com/about/">Gus Khawaja&rsquo;s</a> Pluralsight course &ldquo;Pentration Testing and Ethical Hacking with Kali Linux&rdquo;. Much credit goes to Gus&rsquo;s expertise! Check out his blog in the sources and how to get started with Pluralsight</em></p>
<p>There is a LOT to do when it comes to website penetration testing, and this post is by no means a comprehensive list of everything to do or than can be done. Despite not being comprehensive there is a still a lot of content, and as a result I have created a table of contents ordered in the way that you would naturally progress in a web pentest to help navigate this post</p>





  <h3 id="table-of-contents">Table of Contents <a class="anchor" href="#table-of-contents" title='Anchor for "Table of Contents".'><svg aria-hidden="true"><use xlink:href="#hashtag"/></svg></a></h3> 

<ul>
<li><a href="#setting-up-burp-suite">Configuring Burp Suite</a></li>
<li><a href="#web-application-firewall-waf">Web Application Firewall Scanning</a>
<ul>
<li>Identify the presence of network based protective devices such as firewalls, intrusion detection systems and honeypots</li>
</ul>
</li>
<li><a href="#load-balancing-check">Load Balancing Check</a>
<ul>
<li>Determine if a domain uses DNS and/or HTTP load balancing</li>
</ul>
</li>
<li><a href="#web-crawling">Web Crawling</a></li>
<li><a href="#copy-a-website">Copy the Website Locally</a></li>
<li><a href="#cms-scan">Scan for Content Management System (CMS)</a></li>
<li><a href="#ssl-scan">Scan for Secure Sockets Layer (SSL)</a></li>
<li><a href="#session-tokens">Session Tokens Test</a></li>
<li><a href="#exploiting-sql-injection">Exploiting SQL Injection</a></li>
<li><a href="#maintaining-access">Maintaining Access</a></li>
<li><a href="#denial-of-service-attack">Denial of Service</a></li>
</ul>





  <h2 id="setting-up-burp-suite">Setting Up Burp Suite <a class="anchor" href="#setting-up-burp-suite" title='Anchor for "Setting Up Burp Suite".'><svg aria-hidden="true"><use xlink:href="#hashtag"/></svg></a></h2> 

<p>You will need to use Burp Suite along with some Virtual Machines (VMs) to conduct some of the following tests. To set them up and get a little introduction on how to use them, follow these instructions:</p>





  <h3 id="configuring-a-burp-proxy">Configuring a Burp Proxy <a class="anchor" href="#configuring-a-burp-proxy" title='Anchor for "Configuring a Burp Proxy".'><svg aria-hidden="true"><use xlink:href="#hashtag"/></svg></a></h3> 

<p>Burp proxy allows you to intercept the web traffic between an internet browser and a target application (which is often the web server itself)</p>
<ol>
<li>First thing we&rsquo;re going to want to do is open Burp Suite (you can make just a normal project with all the default settings) and make sure we have our proxy open and listening on port 8080. To do this, using the top tabs, select Proxy -&gt; Options and the first box should be titled &ldquo;Proxy Listeners&rdquo;. There should be an option to check the box next to &ldquo;Interface 127.0.0.1:8080&rdquo; as seen in the picture below. If not, choose &ldquo;Add&rdquo; and add the interface matching these values











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../burpsuiteSS1.png"
      alt="Burp Suite Proxy Settings"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../burpsuiteSS1.png"
        alt="Burp Suite Proxy Settings"
      />
    </noscript>
  
  

</li>
<li>To be able to connect to this proxy, we&rsquo;re going to need to install an add-on for our browser (Firefox is recommended for Burp Suite). The add-on is called <a href="https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/">Foxy Proxy</a> and will allow us to use Burp Suite</li>
<li>Once installed, you should see a little icon of a fox on the top right of your Firefox browser. Go ahead and click on the icon, select Options -&gt; Add and you should see a screen like below. Go ahead fill out your screen with the same values as seen here











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../burpsuiteSS2.png"
      alt="Foxy Proxy Settings"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../burpsuiteSS2.png"
        alt="Foxy Proxy Settings"
      />
    </noscript>
  
  


<br><div style="padding-left: 2em;"><input disabled="" type="checkbox"> What this does is tell our browser to send all our web traffic directed through local host (127.0.0.1, which is us) to port 8080 (the port used for web traffic)</div></li>
<li>Save your new proxy, and you should now see it in your list of available proxies in Foxy Proxy. In a new tab, left click on the Foxy Proxy Icon and you should see your new proxy as an option. Select it and navigate to a website of your choice
<br><div style="padding-left: 2em;"><input disabled="" type="checkbox"> If this is your first time using Burp Suite, chances are you will get an error saying it is not safe to navigate to that website. To fix this problem, WHILE YOUR PROXY IS STILL ON, follow the steps in <a href="https://portswigger.net/burp/documentation/desktop/getting-started/proxy-setup/certificate/firefox">this document</a></div></li>
<li>When you try and navigate to a new website, Burp Suite should pop up and give you a message like this:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../burpsuiteSS3.png"
      alt="Burp Suite Intercept"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../burpsuiteSS3.png"
        alt="Burp Suite Intercept"
      />
    </noscript>
  
  


<br><div style="padding-left: 2em;"><input disabled="" type="checkbox"> What this is showing us is that our proxy has intercepted our request to connect to the website (in this example it is my blog site). You can see that with the intercept option on, we can choose to Forward (continue with) or Drop (delete) the connection attempt. Choose Forward for this example</div></li>
<li>After forwarding the request, you can go back to your browser and see that you have gone to the site of your choice. This process will happen any time you try to navigate somewhere when the Intercept option is on. If we go back to Burp Suite, click on the &ldquo;HTTP history&rdquo; tab at the top and you can see a list of all the internet requests sent to and from your device, and can also click on them to see the full request and response:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../burpsuiteSS4.png"
      alt="HTTP History"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../burpsuiteSS4.png"
        alt="HTTP History"
      />
    </noscript>
  
  

</li>
</ol>
<ul>
<li>You can also go back into the Intercept tab and turn off Intercept. This will prevent you from having to forward every connection request, but still allow you to monitor and record all of the requests in the HTTP history tab</li>
</ul>





  <h3 id="creating-a-burp-target">Creating a Burp Target <a class="anchor" href="#creating-a-burp-target" title='Anchor for "Creating a Burp Target".'><svg aria-hidden="true"><use xlink:href="#hashtag"/></svg></a></h3> 

<p>For some of the following exercises, we will be using <strong>Metasploitable</strong>, a linux operating system preconfigured for penetration testing purposes. To install and use, follow the following instructions:</p>
<ol>
<li>For this next section, we need to create our own website to practice our hacking skills on. To do so, we will use a Virtual Machine (VM) called Metasploitable which comes with a bunch of useful features. Assuming you don&rsquo;t already have an application to host VMs, to set up Metasploitable, you will need to follow the instructions in <a href="https://www.kalilinux.in/2020/09/metasploitable-2-installing-on-kali.html">this guide</a></li>
<li>Once configured, open Firefox and put in the IP address of your Metasploitable virtual machine. To access the browser function, click on the link called Mutillidae. You should see a webpage like this:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../burpsuiteSS5.png"
      alt="Mutillidae Home Page"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../burpsuiteSS5.png"
        alt="Mutillidae Home Page"
      />
    </noscript>
  
  

</li>
<li>Make sure Burp Suite is open and running, turn on your Foxy Proxy, and make sure the Intercept option is turned off. If you go to the Target -&gt; Site Map tab in Burp Suite, you should see the URL of your VM on the left hand side with a drop down where you&rsquo;ll find the Mutillidae website as seen below (you may need to refresh the page if you don&rsquo;t see the URL in your Site Map tab). Go ahead and right click on Mutillidae and click &ldquo;Add to scope&rdquo; which will allow us to define where to direct automated spidering and testing to occur. If a pop up asks you if you want to stop using out of scope resources, select &ldquo;yes&rdquo;











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../burpsuiteSS6.png"
      alt="Add"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../burpsuiteSS6.png"
        alt="Add"
      />
    </noscript>
  
  

</li>
</ol>





  <h3 id="web-application-firewall-waf">Web Application Firewall (WAF) <a class="anchor" href="#web-application-firewall-waf" title='Anchor for "Web Application Firewall (WAF)".'><svg aria-hidden="true"><use xlink:href="#hashtag"/></svg></a></h3> 

<ol>
<li><strong>Wafw00f</strong>: An automated tool used to identify and fingerprint web based firewalls. It is considered to be the most accurate tool for this purpose
<br><div style="padding-left: 2em;"><input disabled="" type="checkbox"> Example: <code>wafw00f s0merset7.github.io</code> - this will detect if the website is protected by any Web Application Firewalls (WAF). As we can see in the picture, it looks like my site is protected by a Fastly <a href="https://www.namecheap.com/supersonic-cdn/cdn-waf/">Content Delivery Network (CDN)</a> firewall </div>











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../wafw00fSS.png"
      alt="Wafw00f Screen Shot"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../wafw00fSS.png"
        alt="Wafw00f Screen Shot"
      />
    </noscript>
  
  

</li>
</ol>





  <h3 id="load-balancing-check">Load Balancing Check <a class="anchor" href="#load-balancing-check" title='Anchor for "Load Balancing Check".'><svg aria-hidden="true"><use xlink:href="#hashtag"/></svg></a></h3> 

<ol>
<li><strong>lbd</strong>: A bash scrip that determines if a given domain uses DNS or HTTP load balancing
<br><div style="padding-left: 2em;"><input disabled="" type="checkbox"> Example: <code>lbd s0merset7.github.io</code> - this command will run checks to determine what, if any, load balancing protocols are in effect on my blog site. As seen in the picture below, it looks like my site uses both DNS and HTTP load balancing and it shows some more information about each </div>











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../lbdSS.png"
      alt="lbd Screen Shot"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../lbdSS.png"
        alt="lbd Screen Shot"
      />
    </noscript>
  
  

</li>
</ol>





  <h3 id="web-crawling">Web Crawling <a class="anchor" href="#web-crawling" title='Anchor for "Web Crawling".'><svg aria-hidden="true"><use xlink:href="#hashtag"/></svg></a></h3> 

<ul>
<li>Web crawlers can be used to verify existing information that has been found as well as determine the existing directory and file structure of a particular site. Things found via web crawlers can include:
<ul>
<li>Administration Portals</li>
<li>Configuration Files - these may contain hardcoded access credentials and information on the internal structure</li>
<li>Backup Copies of the Website</li>
<li>Administrator Notes</li>
<li>Confidential Information</li>
<li>Source Code</li>
</ul>
</li>
<li>Webs Crawlers that exist on Kali include:
<ul>
<li>Burp Suite (we will be using this one in following examples)</li>
<li>Dirbuster</li>
<li>OWASP-ZAP</li>
<li>Vega</li>
<li>Webscarab</li>
<li>Webslayer
The first thing we want to do when web application testing is to spider the host, i.e. crawl through the whole website and record all different files, forms, and HTTP methods on the site. This will allow us to identify where all the links are, what type of parameters are used in the application, what external sites the application references to, and the overall layout of how the application functions</li>
</ul>
</li>
</ul>
<ol>
<li>Burp Suite should automatically do a basic crawl of the website for us. To make sure its working, under the Dashboard tab, you should see something titled &ldquo;Live passive crawl from Proxy (all traffic)&rdquo; as seen below:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../burpsuiteSS7.png"
      alt="Burp Suite Crawler"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../burpsuiteSS7.png"
        alt="Burp Suite Crawler"
      />
    </noscript>
  
  


In Target -&gt; Site Map you should also be able to see a breakdown of the site hierarchy as well as all requests and responses from the scan:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../burpsuiteSS8.png"
      alt="Burp Suite Scan Results"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../burpsuiteSS8.png"
        alt="Burp Suite Scan Results"
      />
    </noscript>
  
  

</li>
</ol>
<ul>
<li>This is only a very basic scan of the website as here I am using Burp Suite Community Edition, which is the free version. There are more advanced scanning and spidering features if you upgrade to the Premium version</li>
</ul>





  <h3 id="copy-a-website">Copy a Website <a class="anchor" href="#copy-a-website" title='Anchor for "Copy a Website".'><svg aria-hidden="true"><use xlink:href="#hashtag"/></svg></a></h3> 

<ol>
<li><code>apt-get install httrack</code> to install the HTTrack tool</li>
<li>To use, run <code>httrack &quot;yourURL&quot; -O &quot;localFileDestination&quot; -v</code> to save a copy of the website at <code>yourURL</code> at <code>localFileDestination</code> in verbose mode. Control+Z will stop the command
<br><div style="padding-left: 2em;"><input disabled="" type="checkbox"> Keep in mind this command will take a long time, and depending on the site can fill up your disk space</div></li>
</ol>





  <h3 id="ssl-scan">SSL Scan <a class="anchor" href="#ssl-scan" title='Anchor for "SSL Scan".'><svg aria-hidden="true"><use xlink:href="#hashtag"/></svg></a></h3> 

<p><strong>SSL Scan Tool</strong>: Analyses a server&rsquo;s Secure Sockets Layer (SSL) configuration and validates the certificate. It also tests for weak cypher suites and identifies the configuration information that may support additional attacks</p>
<ol>
<li><code>sslscan websiteURL</code> - this will query the SSL services in order to determine the certificate details and checks for heartbleed vulnerabilities
<br><div style="padding-left: 2em;"><input disabled="" type="checkbox"> Example: <code>sslscan s0merset7.github.io</code> - lists a bunch of information as to what SSL services are in use and potential vulnerabilities</div>











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../sslSS.png"
      alt="SSL Scan Screen Shot"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../sslSS.png"
        alt="SSL Scan Screen Shot"
      />
    </noscript>
  
  

</li>
</ol>





  <h3 id="cms-scan">CMS Scan <a class="anchor" href="#cms-scan" title='Anchor for "CMS Scan".'><svg aria-hidden="true"><use xlink:href="#hashtag"/></svg></a></h3> 

<p>For this section we are going to need to start another virtual machine. If you still have Mutillidae open, you can shut down that machine and go to <a href="https://www.turnkeylinux.org/wordpress">this site</a> and download the VMDK file. Follow the same steps from the <a href="https://www.kalilinux.in/2020/09/metasploitable-2-installing-on-kali.html">previous guide</a> for setting up the new VM. Once started, you will be prompted to set up passwords for the different accounts, then sign into the root user with the password you set. You should then brought to a screen with several IP addresses listed. Once there, try entering the addresses in your browser and it should bring you to a page like this:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../wordpressSS1.png"
      alt="WordPress VM Home Page"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../wordpressSS1.png"
        alt="WordPress VM Home Page"
      />
    </noscript>
  
  

</p>
<ol>
<li>First thing we need to do is to scan for plugin vulnerabilities. To do this, we can use the <strong>wpscan</strong> tool
<br><div style="padding-left: 2em;"><input disabled="" type="checkbox"> Example: <code>wpscan --url wordpressVmURL --enumerate vp</code> - this will scan the provided URL (which in our case will be the IP address of the VM) by searching for (or enumerating) any plugin vulnerabilities (vp). The output will first show a list of &ldquo;interesting findings&rdquo; of things we should check out, and beneath that provide a list of plugin vulnerabilities as well as information about potential exploits, fixes, and certainty</div></li>
<li>Using wpscan, we can also try and enumerate users
<br><div style="padding-left: 2em;"><input disabled="" type="checkbox"> Example: <code>wpscan --url wordpressVmURL --enumerate u</code> - similar to above, this will do the same thing, except instead of enumerating vulnerable plugins (vp), we now enumerate users (u) which will be provided in a list at the bottom like the picture below. We can see that it has found our admin account:</div>











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../wpscanSS1.png"
      alt="wpscan User Enumeration"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../wpscanSS1.png"
        alt="wpscan User Enumeration"
      />
    </noscript>
  
  

</li>
<li>With the new user we found, we can try and brute force the account with a word list of common passwords (in our case we know the password but this would work for users where you don&rsquo;t). The command for this would be <code>wpscan --url wordpressVmURL --passwords filePathToWordList</code> to attack all user accounts found, or we can target specific users with <code>wpscan --url wordpressVmURL --passwords filePathToWordList --usernames listOfUsers</code>
<br><div style="padding-left: 2em;"><input disabled="" type="checkbox"> Example: <code>wpscan --url 192.168.122.31 --passwords /usr/share/wordlists/rockyou.txt --usernames admin</code> - Kali Linux comes preinstalled with some wordlists in /usr/share/wordlists which is why I&rsquo;m directing the path there. I am also specifying to only attempt the admin user we found. Now if we did a good job making our password, it won&rsquo;t be on this list and the command will run for a long time depending on your processing power. But what you can do to test how a successful attempt would work is to create a txt file with the password you made for the wordpress account and use that file path instead. If you do it right, you should get a little message at the bottom that says &ldquo;Valid Combinations Found:&rdquo; followed by a list of the user and corresponding password</div></li>
</ol>





  <h3 id="session-tokens">Session Tokens <a class="anchor" href="#session-tokens" title='Anchor for "Session Tokens".'><svg aria-hidden="true"><use xlink:href="#hashtag"/></svg></a></h3> 

<p>Session tokens are used by website servers to track sessions to allow for HTTP protocol. We want to make sure that session tokens are created in a non-predictable way so they cannot be replicated. We can use Burp Suite to run an analysis on session tokens</p>
<ol>
<li>Go ahead and start your Metasploitable VM and navigate to the Mutillidae homepage as we&rsquo;ve done before</li>
<li>Go ahead and clear your browser history, this will allow us to trick Mutillidae into thinking this is the first time we are visiting it, which will the generate a new session token for us</li>
<li>Like before, open up Burp Suite and connect your browser to Foxy Proxy. Once here, refresh the Mutillidae page, Burp Suite should pop up with a notification that is requesting the Mutillidae server to connect. Go ahead and forward that request. The next request should look like this:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../sessionTokenSS.png"
      alt="Session Token"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../sessionTokenSS.png"
        alt="Session Token"
      />
    </noscript>
  
  


We can see here on line 9 that the server is assigning us a Session ID token, this is what we&rsquo;re looking for</li>
<li>Forward the rest of the requests until your intercept tab is empty and navigate to Proxy -&gt; HTTP History. Here we can see all of the requests we forwarded. Select the top item so that you can see both the request and response at the bottom of your screen, then right click on the response and select &ldquo;Send to Sequencer&rdquo;











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../sessionTokenSS2.png"
      alt="Session Connection Request and Response"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../sessionTokenSS2.png"
        alt="Session Connection Request and Response"
      />
    </noscript>
  
  

</li>
<li>Navigate to the Sequencer tab and select the &ldquo;Start Live Capture&rdquo; button under the &ldquo;Select Live Capture Request&rdquo; section. A new window should pop up with a progress bar:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../sessionTokenSS3.png"
      alt="Session Token Live Capture"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../sessionTokenSS3.png"
        alt="Session Token Live Capture"
      />
    </noscript>
  
  


What this is doing is generating thousands of session tokens from this site. What we are trying to do is generate enough tokens to get a large enough sample size to perform a statistical analysis and determine if they are secure or not</li>
<li>For our purposes, we don&rsquo;t have to run the entire live capture session as depending on your processor that might take too long so when you are ready, press &ldquo;Pause&rdquo; and then &ldquo;Analyse Now&rdquo;</li>
<li>A report should pop up that starts with a summary of the statistical analysis and a general statement indicating whether or not they are random enough. You can also check out the other tabs in the report to find out how the session tokens are generated for this specific site and how different aspects of them are analyzed











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../sessionTokenSS4.png"
      alt="Session Token Analysis Results"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../sessionTokenSS4.png"
        alt="Session Token Analysis Results"
      />
    </noscript>
  
  

</li>
</ol>





  <h3 id="exploiting-sql-injection">Exploiting SQL Injection <a class="anchor" href="#exploiting-sql-injection" title='Anchor for "Exploiting SQL Injection".'><svg aria-hidden="true"><use xlink:href="#hashtag"/></svg></a></h3> 

<p>One of the most common website vulnerabilities is the injection vulnerability, which allows an attacker to interact with the backend database of a web server
<strong>sqlmap</strong>: A python tool that automates the reconnaissance and exploitation of multiple types of databases</p>
<ol>
<li>Before running sqlmap, we need to change a setting of Metasploitable. To do this, make sure your VM is running and in the terminal, run <code>ssh msfadmin@ipAddressOfVm</code> this will prompt you for a password, which the default is <code>msfadmin</code></li>
<li>Once we have terminal access, we need to open up the &ldquo;config.inc&rdquo; file in a text editor of your choosing. Make sure you run the command with <code>sudo</code> or else you won&rsquo;t be able to make changes. I used vim with this command <code>sudo vim /var/www/mutillidae/config.inc</code></li>
<li>Once the file is opened up, we&rsquo;re going to want to replace &ldquo;metasploit&rdquo; in the database name section with &ldquo;owasp10&rdquo; as seen below. Once done, exit and save (<code>:wq</code> if using vim)











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../sqlInjectionSS1.png"
      alt="config.inc Changes"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../sqlInjectionSS1.png"
        alt="config.inc Changes"
      />
    </noscript>
  
  

</li>
<li>Go to the Mutillidae home page and using the left hand options, select OWASP Top 10 -&gt; A1-Injection -&gt; SQLi-Extract Data -&gt; User Info. You should see a page that looks like this:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../sqlInjectionSS2.png"
      alt="User Info Page"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../sqlInjectionSS2.png"
        alt="User Info Page"
      />
    </noscript>
  
  

</li>
<li>Open up Burp Suite and connect it to Foxy Proxy. Enter anything you want in the name and password field so long as you can remember it (I used &ldquo;name&rdquo; and &ldquo;password&rdquo; to keep it simple). In Burp Suite, find the request matching the username and password request, right click, and select &ldquo;Save Item&rdquo;. Make sure to make it somewhere accessible. The request should look something like this:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../sqlInjectionSS3.png"
      alt="Login Request"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../sqlInjectionSS3.png"
        alt="Login Request"
      />
    </noscript>
  
  

</li>
<li>In a new terminal window, run <code>sqlmap -r /filePathToSavedFile --dbs</code>. What this does is look at the request we just saved and compares it to a bunch of different SQL injection databases, seeing if there are any that know exploits we can use. When the command runs (it will likely take a while), there will be several prompts for user input, you can read them if you&rsquo;d like, but selecting &ldquo;yes&rdquo; for all of them will give us the results we need, which should look like this, a list of databases we can use:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../sqlInjectionSS4.png"
      alt="SQLMap Results"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../sqlInjectionSS4.png"
        alt="SQLMap Results"
      />
    </noscript>
  
  

</li>
<li>Generally, the OWASP10 database is very reliable so we will use that one here. First we need to query what tables within the OWASP10 database we should be using for this exploit. To see that, run <code>sqlmap -r /filePathToSavedFile -D owasp10 --tables</code> and you should get a result like this:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../sqlInjectionSS5.png"
      alt="SQLMap OWASP10 Database Usable Tables"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../sqlInjectionSS5.png"
        alt="SQLMap OWASP10 Database Usable Tables"
      />
    </noscript>
  
  

</li>
<li>Since we are dealing with login information, we will want to use the &ldquo;Accounts&rdquo; table. To execute the attack, we can run <code>sqlmap -r /filePathToSavedFile -D owasp10 -T accounts --dump</code>. This will run the attacks on the website using the information from our txt file. And we can see it works with the results even managing to give us 16 plaintext usernames and passwords that you can successfully plug into the Mutillidae website











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../sqlInjectionSS6.png"
      alt="SQL Injection Results"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../sqlInjectionSS6.png"
        alt="SQL Injection Results"
      />
    </noscript>
  
  

</li>
</ol>





  <h3 id="maintaining-access">Maintaining Access <a class="anchor" href="#maintaining-access" title='Anchor for "Maintaining Access".'><svg aria-hidden="true"><use xlink:href="#hashtag"/></svg></a></h3> 

<p>Web Shell: a small program that provides stealthy backdoor access and allow the use of system comments to facilitate post exploitation activities
<strong>Weevely</strong> - popular PHP web shell pre-installed on Kali Linux that simulates a telnet session and allows the tester to take advantage of more than 30 modules for post exploitation tasks such as file browsing, file transfer, auditing, compromising SQL servers, reverse TCP shells, command execution</p>
<ol>
<li>First thing we need to do is create the exploit file. Run the command <code>weevely generate password filename.php</code> where <code>password</code> can be whatever password you want and <code>filename.php</code> is the name you want to give to the PHP file. This command will save the PHP file in the directory you run this command</li>
<li>Open up the Metasploitable VM and go to the DVWA page. It should look like this:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../uploadVulnSS1.png"
      alt="DVWA Home Page"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../uploadVulnSS1.png"
        alt="DVWA Home Page"
      />
    </noscript>
  
  

</li>
<li>You can sign in with the default user and password &ldquo;admin&rdquo; and &ldquo;password&rdquo;. Once in, select the &ldquo;DVWA Security&rdquo; button on the left and change the security level to &ldquo;low&rdquo; as seen here:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../uploadVulnSS2.png"
      alt="DVWA Security Page"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../uploadVulnSS2.png"
        alt="DVWA Security Page"
      />
    </noscript>
  
  

</li>
<li>Next, select the &ldquo;Upload&rdquo; tab on the left which should bring you to a page with the option of uploading files. Go ahead and upload the Weevely file you created and you should get a message that looks like this:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../uploadVulnSS3.png"
      alt="Successful Upload"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../uploadVulnSS3.png"
        alt="Successful Upload"
      />
    </noscript>
  
  

</li>
<li>Go ahead and copy the link from the success message and paste it in your browser after /dvwa (ie for me, the link I would check is <code>http://192.168.122.222/dvwa/hackable/uploads/weevely.php</code>). We want to check that there were no errors. If you uploaded the file correctly, you should see a blank white screen</li>
<li>Copy the full URL and in the terminal, type the command <code>weevely fullURL password</code> where <code>password</code> is the previous password you entered when creating the Weevely file and <code>fullURL</code> is the entire URL for where you checked if the file was properly uploaded. Once you execute, you should have successfully created a web shell that you can interact with and execute commands











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../uploadVulnSS4.png"
      alt="Successful Web Shell"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../uploadVulnSS4.png"
        alt="Successful Web Shell"
      />
    </noscript>
  
  

</li>
</ol>





  <h3 id="denial-of-service-attack">Denial of Service Attack <a class="anchor" href="#denial-of-service-attack" title='Anchor for "Denial of Service Attack".'><svg aria-hidden="true"><use xlink:href="#hashtag"/></svg></a></h3> 

<p><strong>Low Orbit Ion Cannon (LOIC)</strong>: simple denial of service tool that floods a target with TCP, UDP, or HTTP requests. This is a very dangerous tool and needs to be used properly/ethically</p>
<ol>
<li>We need to download a few dependencies before using LOIC. Run <code>apt-get install mono-mcs -y</code> and <code>apt-get install liblog4net-cil-dev</code>. Then you&rsquo;re going to want to go to <a href="https://www.monodevelop.com/download/#fndtn-download-lin">this site</a> and follow the instructions to download MonoDevelop</li>
<li>Go to the <a href="https://github.com/NewEraCracker/LOIC">LOIC Github repository</a> and download the zip file. Move the file to a location you want to keep the tool, and unzip it</li>
<li><code>cd</code> into the newly created <code>LOIC-master</code> directory, and run <code>./loic.sh install</code>. This will likely take a while</li>
<li>Once done, run <code>./loic.sh run</code> and a window that looks like this should pop up:











  






  
  
    <img
      class="lazyload "
      loading="lazy"
      src="data:image/gif;base64,R0lGODdhAQABAIABAICAgDfSzywAAAAAAQABAAACAkQBADs="
      data-src="../loicSS.png"
      alt="LOIC Screen Shot"
    />
    
    <noscript>
      <img
        
        loading="lazy"
        src="../loicSS.png"
        alt="LOIC Screen Shot"
      />
    </noscript>
  
  

</li>
<li>From here, you can enter the IP address or URL of your target, choose the type of requests to send (TCP is the default), and run the program by clicking &ldquo;IMMA CHARGIN MAH LAZER&rdquo;. PLEASE TAKE CAUTION USING THIS APPLICATION as using it on websites or IP addresses without their direct consent is ILLEGAL. Once you run it, you can see the requests happening as time goes on. Click the start button again to end the DOS attack</li>
</ol>





  <h2 id="sources">Sources <a class="anchor" href="#sources" title='Anchor for "Sources".'><svg aria-hidden="true"><use xlink:href="#hashtag"/></svg></a></h2> 

<ul>
<li><a href="https://ethicalhackingblog.com/">Gus Khawaja&rsquo;s Blog</a></li>
<li><a href="https://www.pluralsight.com/courses/kali-linux-penetration-testing-ethical-hacking">Gus&rsquo;s Pluralsight Course: “Pentration Testing and Ethical Hacking with Kali Linux”</a></li>
<li><a href="https://portswigger.net/burp">Burp Suite Official Site</a></li>
</ul>



    </article>
  </main>


    </div>
    
    <footer>
      

  <p>Copyright © 2021
All rights reserved</p>












<section class="req-js">
  <button class="outline-dashed" title="Change to light/dark mode."><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><use xlink:href="#adjust"/></svg></button><input class="outline-dashed" type="color" list="presets" value="#902b37" title="Change accent color." aria-label="Change accent color."><datalist id="presets"><option value="#225670"><option value="#902b37"><option value="#1f676b"><option value="#f3a530"><option value="#dd587c"><option value="#1dbc91"><option value="#754e85"><option value="#7fc121"><option value="#a8314a"><option value="#ff7433"><option value="#3e6728"><option value="#c063bd"></datalist>
</section>



  <noscript>
    <p class="noscript">Unable to execute JavaScript. Some features were disabled.</p>
  </noscript>



    </footer>
    
    <svg xmlns="http://www.w3.org/2000/svg" width="0" height="0" aria-hidden="true">
      <symbol viewBox="0 0 512 512" id="adjust">
        <path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705 0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/>
      </symbol>
      
      
      
      
  
<symbol viewBox="0 0 448 512" id="hashtag">
  <path d="M440.667 182.109l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l14.623-81.891C377.123 38.754 371.468 32 363.997 32h-40.632a12 12 0 0 0-11.813 9.891L296.175 128H197.54l14.623-81.891C213.477 38.754 207.822 32 200.35 32h-40.632a12 12 0 0 0-11.813 9.891L132.528 128H53.432a12 12 0 0 0-11.813 9.891l-7.143 40C33.163 185.246 38.818 192 46.289 192h74.81L98.242 320H19.146a12 12 0 0 0-11.813 9.891l-7.143 40C-1.123 377.246 4.532 384 12.003 384h74.81L72.19 465.891C70.877 473.246 76.532 480 84.003 480h40.632a12 12 0 0 0 11.813-9.891L151.826 384h98.634l-14.623 81.891C234.523 473.246 240.178 480 247.65 480h40.632a12 12 0 0 0 11.813-9.891L315.472 384h79.096a12 12 0 0 0 11.813-9.891l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l22.857-128h79.096a12 12 0 0 0 11.813-9.891zM261.889 320h-98.634l22.857-128h98.634l-22.857 128z"/>
</symbol>


  <symbol viewBox="0 0 320 512" id="caret-down">
    <path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"/>
  </symbol>


      
      
      
    </svg>

    
    
    

      <script>
        
          'use strict';const PALETTE=document.querySelector('footer input');PALETTE.onchange=function(){const a=PALETTE.value;SHEET.setProperty('--accent',a),ROOT.dataset.mode==='light'?localStorage.setItem('lightAccent',a):localStorage.setItem('darkAccent',a),updateAccent()}
        
      </script>

    
    
    
    

  </body>
</html>
